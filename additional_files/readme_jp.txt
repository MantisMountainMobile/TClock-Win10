***********************************************
***  Tclock-Win10 Ver 4.5.0.1 (2022/02/13)  ***
***       by Mantis Mountain Mobile         ***
***********************************************

※Ver 4.5よりGitHubへの公開に移行しました。
当面Vectorサイトでの公開も行う予定です。
第三者(Vector)によるウィルスチェックを経たという安心を求める方はVectorよりダウンロードしたファイルをご利用ください。
(ただし2022/2/13時点でVectorはサービストラブル中で更新が遅れる予定です)。
https://www.vector.co.jp/soft/winnt/personal/se518700.html

*******************
Ver. 4.5.0.1 (2022/02/13) の更新点

・メインの公開方法をGitHubに移行しました。
・Windows11において設定色によっては通知アイコンが正しく表示されない問題を修正しました。

*******************

********
はじめに
********
・本ソフトウェアは、Windows10 (Anniversary Update 以降)およびWindows11で動作するTClockです。
Ver 4.0.1でWindows11に対応しました。

・本ソフトウェアは、
TClock2ch最終バージョン(tclock-101021-analog) (by Kazubon氏 -> 2ch有志)
のソースコードをベースに、
TClockLight-kt160911 (by Kazubon氏 -> K. Takata氏)
を参考にしてWindows10 Anniversary Updateに対応させ、現在は他のソフトで代替可能と思われる機能を削除しています。
ベースとなったTClock2ch-analogが備えていたグラフ表示機能が使えるほか、ネットワーク情報の取得などの新機能を付加しています。

・特殊な形態で発展を遂げてきたTClock系ソフトの歴史をお知りになりたければ、以下のサイトを参照してください。
TClock付属サイト：
http://tclock2ch.no.land.to/

・本プログラムが存在するのはひとえにKazubon氏、K.Takata氏、および多くのネット上の開発参加者の功績です。

・本ソフトウェアはフリーソフトです。

・TClockおよびTClock LightがGNU GPLでの配布がなされていますので、本ソフトウェアもGNU GPLに従って再配布または変更することができます。

・本ソフトウェアに関する問い合わせ先
mantis.mountain.mobile@gmail.com
※TClock-Win10以外のTClock系ソフトについてはお答えできませんのでご了承ください。

************
利用上の注意
************
・ほかのTClock系ソフトと同様に、本ソフトを利用することによって生じた一切の損害等の責任は負いません。

・本ソフトのベースはTClock2chであり、TClockLight系(現在はTClockLight-kt)とは別の系統になります。書式等、TClockLight系と異なる点がありますのでご注意ください。

・ユーザ権限で操作可能なフォルダ(例：ユーザーアカウント内)に置いて運用することを想定しています。
Program Files等のWindows管理下のフォルダではなく、個人フォルダに置いて利用してください。
(Program Filesの中でも動くかもしれませんが、確認していません。)

・本ソフトは設定に問題がある場合や、環境との相性により、エクスプローラーを巻き込んでクラッシュし、ループすることがあります。
その場合はタスクマネージャーからプロセスを強制終了する必要がありますが、終了を容易にするために『セーフモード』を搭載しています。
前回起動から20秒以内に起動された場合、不安定要因になる機能を停止して起動するため、TClockの右クリックメニューを開いて終了できる場合があります。
その際、タスクトレイの書式先頭に"[SafeMode]"の表示が現れます。

・ツールチップで日本語を使いたい場合にはShift-JISのエンコードとして下さい。

[既知の問題]
・Windows Updateによる再起動直後は、フォントサイズが正しく反映されず表示がおかしくなります。もう一度Windowsを再起動すると直ります。

・タスクバー位置・サイズの動的な変更に完全には対応できていません。必要に応じてTClock-Win10の再起動を行ってください。

・WiFiを含む接続プロファイル数が特定の数(現時点では128)を超えると、超過分は処理できません。
Windowsの『設定』->『ネットワークとインターネット』->『WiFi』->『既知のネットワークの管理』から、使用していないWiFi接続設定を削除して減らしてください。

********************
バージョンアップ方法
********************
・解凍して出てきたファイルのうち、以下の3ファイルを既存のTClock-Win10のフォルダに上書きコピーしてください。これまでの設定を維持したまま更新できます。
01. TClock-Win10.exe：		メインプログラム
02. tcdll-win10.dll：		タスクバー改造モジュール
03. tclang-win10.dll：		言語モジュール

****************
インストール方法
****************
・以下のファイルを同一のフォルダに入れて、TClock-Win10.exeを実行してください。

[必須ファイル (3つ)]
01. TClock-Win10.exe：		メインプログラム
02. tcdll-win10.dll：		タスクバー改造モジュール
03. tclang-win10.dll：		言語モジュール

[任意ファイル]
04. tclock-win10.ini: 		設定ファイル。なければデフォルト設定で新規作成されます(推奨)。一部の設定項目はこのtclock-win10.iniを直接編集する必要があります。
05. readme_jp.txt: 		このファイル。
06. tclock_tooltip.txt: 	ツールチップ内容ファイル。デフォルト設定ファイル名。サンプルファイルを同梱しています。日本語利用の場合はShift-JISエンコードで。
07. tclock.bmp: 		アナログ時計背景ファイル。デフォルト設定ファイル名。サンプルファイルを同梱しています。
08. UnplugDrive.exe： 		フリーソフトUnplugDrive Portableの実行ファイルで、配布zipには含まれていません。TClockのフォルダ直下に入れておくと、リムーバブルドライブ取り外し機能を利用することができます。

[自動生成ファイル]
09. TClock-Win10.log:		通常動作記録のログです。不要な方はtclock-win10.iniを開いて、NormalLog=0にしてください。
10. TCLOCK-WIN10-DEBUG.LOG:	デバッグ用のログです。普通は生成されません。tclock-win10.iniでDebugLog=1にすると生成されますが、日常的にデバッグログを出力させるのは、ディスクアクセスが増えるのでお勧めしません。

・書式設定について
デフォルト設定では標準的な表示設定としています。
拡張的な書式については、まずは以下の文字列を『右クリックメニュー』⇒『時計』⇒『書式』のカスタム書式欄に入力してどんな情報を表示できるか見ていただき、不要な表示を削除して気に入った設定を探すことをお勧めします。(最後の『"』も入力してください)
[ICP] WiFi LTE "U"NSSK___x"KB/s" Vol  ADBCS "CPU"CU__x"%" WCSmm/dd ddd\nVPNS NMX1 "D"NRSK___x"KB/s" VL__xVMBL__x"%" CC___x"MHz" hh:nn:ss" "

・Windowsのディスプレイ設定の『拡大縮小とレイアウト』が100%以外の場合には、右クリックメニューや設定ダイアログの文字がぼけることがあります。
その場合は、エクスプローラーでTClock-Win10.exeのプロパティを開いて、
『互換性』タブの『高DPI設定では画面のスケーリングを無効にする』のチェックを入れる
もしくは
『互換性』タブの『高DPI設定の変更』⇒『高いDPIスケールの動作を上書きする(拡大縮小の実行元：アプリケーション)』のチェックを入れる
のいずれか、現われる画面に合わせて設定変更をを行ったうえで、TClockを起動してください。

・VC++ラインタイムパッケージについて
本ソフトウェアは、VC++のランタイムパッケージを必要とします。TClock-Win10.exeをダブルクリックして
『VCRUNTIME140.dllが見つからないため、コードの実行を続行できません。…』
『MSVCP140.dllが見つからないため、コードの実行を続行できません。…』
というメッセージが出た場合は、Microsoftが配布している、
Visual Studio 2015 Visual C++ 再頒布可能パッケージ
https://www.microsoft.com/ja-jp/download/details.aspx?id=48145
をインストールしてください(64bit版ならvc_redist.x64.exe)。
(2019/4月現在のURL)

********************
アンインストール方法
********************
・フォルダごとファイルを消去してください。

・レジストリは使用していません。

・右クリックメニュー⇒『tclockのプロパティ』⇒『その他』タブにある『レジストリ削除』ボタンは有効です。
過去のTClock系ソフトによるレジストリエントリをまとめて消すことができます。

**********
概要・特徴
**********
TClock2chの機能のうち、現在はほかのソフトで代替可能と思われるものを削除した上で、追加機能を搭載しています。

・TClock2ch-analogの特徴であったグラフ表示機能を利用することができます。

・設定管理は、iniファイル(tclock-win10.ini)に一元化しました。レジストリは使用しないようになっています。
従来からのレジストリ情報削除機能は利用可能です。

・初回起動時に、設定ファイルが存在しなければデフォルト設定でプログラムフォルダ内に作成します。
作成に失敗すると動作を終了します。

・本アプリはVisual Studio 2015によりビルドされています。

・本アプリは日本語環境での利用を想定していますが、右クリックメニューから表示言語を英語に変更できるようになっています。

・タスクバーへの情報表示を重視し、操作・制御系の機能は大幅に削減しました。

・Windows10ではEthernet, WiFi, LTE(WAN)に同時接続して、その中からEthernet > WiFi > LTEの順でインターネット接続に利用する仕組みになっているので、それぞれの接続状態、通信状態、どれがインターネット接続に優先利用されているか、を取得できるようにしました。

・WiFi接続のSSID、WAN(LTE)接続のアクセスポイント名を表示することができます。
また通信状況に合わせて自動で切り替えて表示する機能もあります(NMX1, NMX2書式を参照してください)。

・BL(バッテリ残量%)、VL&VM(ボリュームとミュート状態)、CU(CPU負荷)、通信速度を示すバーを背景に表示できます。

・右クリックメニューからリムーバブルドライブの取り外しができます。(要UnplugDrive.exe)

・一部のVPN接続時に、インジケータを表示することができます(設定ファイルにVPN接続識別キーワード設定が必要です)。

**********************
利用方法・設定変更方法
**********************
[TClock2ch由来の機能]
・基本的な利用方法は、TClock付属サイト
http://tclock2ch.no.land.to/

の、『TClock2chのヘルプ』を参照してください。
http://tclock2ch.no.land.to/help2ch/

特に、旧来のカスタム書式については以下に説明があります。使えなくなっているものもあります。
http://tclock2ch.no.land.to/help2ch/template.html

少なくとも、以下の点は旧来のバージョンと異なっています。
・TClock2chはWiFiのネットワーク送受信量を正しく検出できませんでしたが、対応しています。またネットワーク速度の折れ線グラフ表示で対数プロットができていなかったのを修正しました。

・TTBase連携機能、およびデスクトップカレンダーとの連携機能は廃止しました。利用できません。

・そのほか以下の機能を削除しています。	ウィンドウの配列・操作機能
	タイマー機能
	カレンダー機能
	ツールチップへのWEB表示機能
	スタートボタンの改造や、スタートメニューの改造機能
	複数設定保存機能
	ボリューム調節機能
	時刻合わせ機能
	デスクトップアイコン改造機能

・『iniファイル』
http://tclock2ch.no.land.to/help2ch/ini.html
TClock-Win10ではiniファイル(tclock-win10.ini)に完全移行しており、iniファイルを自動作成します。
作成失敗すると起動できません。

[TClock-Win10で改変・新設した機能の設定について]
・新設した機能のうち、変更する可能性が低いものについては現時点で設定ダイアログが実装されていません。
tclock-win10.iniを直接編集してください。TClockの再起動が必要です。

・VPN接続が検出されない場合には、『TClockのプロパティ』⇒『その他』タブ⇒VPNキーワードの項目内にVPN用のネットワークアダプタ名の一部を登録してください。

・右クリックメニュー最上段の"Language"から、右クリックメニュー自体の言語を日本語/英語で切り替えできます。

・Ethernetに接続しているはずなのに判別できない場合は、『TClockのプロパティ』⇒『その他』タブ⇒Ethernetキーワードの項目内にEithernetネットワークアダプタの名前の一部を登録してください。

**********************************
********** セーフモード **********
**********************************
・前回の起動から20秒以内に起動した場合には、起動失敗によるループに入っているものと判断し、セーフモードとなります。。

・これによりExplorerが落ち続けて、タスクマネージャーからでないとTClockが止められなくなる事態を回避できる可能性があります。
前回から20秒以上時間がたってから起動した場合や、手動再起動すると解除されます。

****************************************
TClock-Win10で改変・新設した機能：書式
****************************************

※一部の書式はデバッグ目的で入れた機能ですが、使えることもあると思い残してあります。

[バージョン]
VerTC 	TClock-Win10バージョン文字列。

[接続状態・通信状態インジケータ]
LTE	LTE接続成立したら文字列"LTE "が表示される※。
アスタリスク("LTE*"になる)で通信状態表示(デフォルトでは半角4文字幅)
※接続時の表示文字列は、iniファイル内のLTEStringで変更可能です。

WiFi	WiFi接続成立したら文字列"WiFi "が表示されます。
アスタリスク("WiFi*"になる)で通信状態表示(半角5文字幅)

EthS	Ethernet接続成立したら文字列"Eth "が表示されます。
アスタリスク("Eth*"になる)で通信状態表示(半角4文字幅)

EthL	Ethernet接続成立したら文字列"Ethernet "が表示されます。
アスタリスク("Ethernet*"になる)で通信状態表示(半角9文字幅)

※Ethernetに接続しているはずなのに判別できない場合は、『TClockのプロパティ』⇒『その他』タブ⇒Ethernetキーワードの項目内にEithernetネットワークアダプタの名前の一部を登録してください。

NMX1(NMX2) (※半角10文字幅)(NMX1でもNMX2でも表示は同じです)
	現在アクティブなネット通信経路について自動切り替えで情報表示します。
	Ethernet接続成立したら文字列"Ethernet "が表示される。
	アスタリスクで通信状態表示("Ethernet*"になります)。
	WiFiでインターネット接続中はSSIDを表示。
	LTE(WAN)接続中はアクセスポイント名を表示します。
※文字列幅はtclock-win10.iniの中の[ETC] NetMIX_Lengthで設定できます。

SSID, APN (※半角10文字幅)
	WiFiおよびLTE(WAN)の接続が成立(InternetConnection)したらSSIDやアクセスポイント名APNを表示します。
	現在アクティブな経路でなく、バックグラウンドでも接続成立したら表示されます。
※文字列幅はtclock-win10.iniの中の[ETC] SSID_AP_Lengthで設定できます。

VPNS	VPN接続時には"VPN"を表示。非接続時は"   "(半角3文字幅)

EWLS	Ethernet / WiFi / LTEの接続状態を表示("E*W*L*"のようにスペースなし)(半角6文字幅)※

EWLL	Ethernet / WiFi / LTEの接続状態を表示("E* W* L*"のようにスペースが入っている)(半角8文字幅)※

ICP	以下を表示(半角1文字幅)
表示文字：
   -	インターネット接続経路なし
   E	インターネット接続経路: Ethernet
   W	インターネット接続経路: WiFi
   L	インターネット接続経路: LTE(WAN)※
   M	インターネット接続経路: 従量課金WiFi(Metered WiFi)

※EWLS、EWLL、ICP書式におけるLTE(WAN)時の表示文字は、tclock-win10.iniファイル内のLTECharで変更可能です(先頭文字のみ有効)。

[通信プロファイル情報]
WANP (WAN Profile)			接続プロファイルの中の、LTE(WAN)のプロファイル番号(未接続の場合は推定)
DPRP (Data Plan Retrieved Profile)	接続プロファイルの中の、データ通信利用状況取得対象のプロファイル番号
AIPF (Active Internet ProFile)		接続プロファイルの中で、現在インターネット接続に使われているプロファイル番号

[IPアドレス](15文字)
IPE	イーサネット
IPW	WiFi
IPL	LTE(WAN)
IPV	VPN
IPA	上記のうち、現在Activeなもの

[充電状態表示]
"BCS" Battery Charge Status
バッテリ充電中は"*"、非充電中は" "を表示(半角1文字幅)

[ミュート状態表示機能]
VM	ミュート状態では、iniファイル内のMuteStringで設定した文字列(デフォルトは"*")を表示します。
非ミュート時は同じ文字数のスペース。

[秒表示修正インジケータ]
FTA	Flag Timer Adjustment	秒表示を(ある程度)正確にするためにタイマを再設定した場合に(1秒間だけ)"*"を表示します(普段は" ")。
アルゴリズム的にTClockの秒表示の正確さには限界がありますので、多くの場合、気にしても仕方がありません。

[累積通信量(拡張)]
従来のNSAK(KB), NSAM(MB), NRAK(KB), NSRAM(MB)表記に加え、以下の書式を追加しました。
http://tclock2ch.no.land.to/help2ch/template.html
# NSAG      = 総送信量 ( GB 単位 )
# NRAG      = 総受信量 ( GB 単位 )
これら2つの書式は、桁指定方法は以前と同じ(少数表示可能)です。

加えて、以下の自動単位表示を追加しました。
NSAA	(NetSendAllAutodigit)		Tclock起動からの全送信量(自動単位)
NRAA	(NetRecieveAllAutodigit)	Tclock起動からの全受信量(自動単位)
小数点込みで4文字+半角2文字の単位(KB->MB->GB)が付きます。

[メモリ情報(拡張)]
従来のMTPK等の表示について、最後の文字を"G"にすることでGB単位の表示ができます。
GB表記では、小数点以下の桁指定が可能な"#"タイプの書式になります。
*Windowsのタスクマネージャ等の表記と一致させるため、これらではtclock.ini内のMegabytesInGigaByteの値にかかわらず、1GB=1024MBで計算されます。
http://tclock2ch.no.land.to/help2ch/template.html

# MS	= 物理メモリ量 ( GB 単位, 整数値, 1GB = 1000MBで計算, システム搭載メモリ表記として利用可能)
# MG	= 物理空きメモリ量 ( GB単位 ) < MAPG と同様 >
# MTPG	= 物理メモリ量 ( GB 単位 )
# MAPG	= 物理空きメモリ量 ( GB単位 ) < MG と同様 >
# MUPG	= 物理使用メモリ量 ( GB 単位 )
# MTFG	= ページファイルメモリ量 ( GB 単位 )
# MAFG	= ページファイル空きメモリ量 ( GB 単位 )
# MUFG	= ページファイル使用メモリ量 ( GB 単位 )
# MTVG	= 仮想メモリ量 ( GB 単位 )
# MAVG	= 仮想空きメモリ量 ( GB 単位 )
# MUVG 	= 仮想使用メモリ量 ( GB 単位 )

[時差設定]
TClock Lightをまねた時差書式を実装しました。
td±時:分の形で書きます。±は半角の"+"または"-"、時, 分とも半角数字2桁で24時間以上の時差は無効です。
宣言してから次の宣言まで有効で、元に戻すには『td+00:00』もしくは『td-00:00』としてください。
なお試験的に以下も実装してあります。十分に検証していませんのでご注意ください。
tu±時:分	北米夏時間補正あり。時:分は標準時差を入力します。
te±時:分	ヨーロッパ夏時間補正あり。時:分は標準時差を入力します。
StU, StE	夏時間インジケータ(夏時間は"*", 通常は" ")。この書式より前で一番近いtuやteによる時差設定を反映します。

CUeXX, CCeXX:	論理プロセッサ(スレッド)番号XX(半角数字二桁)の負荷とクロックです。従来のCCX, CUXに準ずる機能ですが二桁の論理プロセッサ番号に対応しました。
それほど正確でないので参考程度と考えてください。クロックも物理コアを共有する2つの論理プロセッサの間で一致しません。
※従来の書式の説明ではコア番号、と書かれていますが実際には論理プロセッサ(スレッド)です。物理コアごとの表示はできていません。

PCORE:		物理コアの数
LPROC:		論理プロセッサ(スレッド)の数

********************************************
tclock-win10.ini設定項目 (値はデフォルト値)
********************************************
[Main]セクション
DebugLog = 0
TRUE(1)ならデバッグ用ログファイルの生成を行う。手動設定用。AutoClearLogFile=0だとどんどんファイルが大きくなるので注意。

NormalLog = 1
TRUE(1)なら通常動作記録用のログファイルの生成を行う。手動設定用。起動時にログファイルのサイズが10KBを超えている場合は以前のデータをクリアします。

AutoClearLogFile = 1
デバッグログファイルの肥大化を防ぐため、一定量ごとにファイルをクリアするかどうか。TRUE(1)ならクリアする。FALSE(0)ならクリアしない。

AutoClearLogLines = 1000
ログファイルをクリアするおおよその行数。厳密ではありません。

AutoRestart = 1
エクスプローラがクラッシュしたときに再起動するかどうか。
まれに、TRUE(1)にしてTClockのプロセスは復活したのに時計の改造が行われない場合や、FALSE(0)にしても、タスクトレイ表示が消えてるにもかかわらずプロセスが残る場合があるので注意してください。
その場合はタスクマネージャーからTClock-Win10のプロセスを強制終了してください。

CompactMode = 0
TRUE(1)にすると、ネットワーク関係のWinRT APIを使わない範囲の機能に限定されます
(多くのデータプラン関係の書式が使えなくなります。)
※LTEデータ利用状況取得をOff(右クリックメニュー or ダイアログ設定 or UseDataPlanFunction = 0)にしても起動失敗するときは、CompactMode = 0;にしてください。

EnglishMenu = 0
TRUE(1)にすると、右クリックメニューが英語になります。右クリックメニューからも変更可能です。

AdjustThreshold = 200
何ミリ秒、秒表示タイミングが遅れるとタイマの修正を行うかの閾値。100-500の間の値で変更できますが、変更しないことをお勧めします。
500にすると修正はかかりませんが、どんどん遅れるわけではなく、時々秒表示が飛ぶだけです。
一方、小さくすればある程度正確になる傾向はありますが、そもそもTClockのアルゴリズム上、秒表示は参考程度です。
この設定値もms単位ですが、実際にはmsの精度はありません。一説によれば16m程度だそうです。
むしろPCの性能との兼ね合いでタイマ再設定処理が増えてしまって負荷が増える可能性があります。
PC(OS)のタイマ機能が不安定になる場合があるので、AdjustThresholdをどんなに小さく設定しても、10秒に1回しか補正はかかりません。
FTA書式で修正がかかったことを見ることができますが、あまり気にしないほうがいいでしょう。

[Status_DoNotEdit]セクション
動作中のデータを保存します。
手動での編集は無効です。誤動作を避けるため、編集しないでください。
以下、参考までに。
Version：		バージョン情報です。
SafeMode：		前回起動から20秒以内に起動された場合には1になります。
LastLaunchTimeStamp：	起動時刻の記録です。
ExcessNetProfiles：	接続プロファイルが128個を超えた場合にTRUE(1)になります。不要なプロファイルの削除が必要です。
ExistLTEProfile：	接続プロファイルの中にLTE(WAN)のプロファイルが見つかった場合にTRUE(1)になります。
ExistMeteredProfile：	接続プロファイルの中に従量課金WiFiのプロファイルが見つかった場合にTRUE(1)になります。
PreviousLTEProfNumber：	前回にインターネット接続がLTE(WAN)で成立した際のプロファイル番号です。LTEでインターネット接続が成立した際に更新されます。
PreviousLTEProfName：	前回にインターネット接続がLTE(WAN)で成立した際のプロファイル名です。LTEでインターネット接続が成立した際に更新されます。
BatteryLifeAvailable：	バッテリ残量情報が取得できるかどうか。ノートPCなどバッテリを備えている場合はTRUE(1)、デスクトップPCなどではFALSE(0)になります。
CurrentInternetProfileNumber：	インターネット接続のプロファイル番号です。
NumberOfProfiles:	インターネット接続プロファイルの個数です。なおプロファイル番号の最大値はこの値より1つ小さくなるので注意してください。
TimerCountForSec:	タイマ処理のパラメータ。1000が初期値ですが自動的に調整されて少し小さな値になるのが普通です。何ミリ秒のつもりで内部タイマを設定したら、ほぼ1秒ごとの動作が得られるかを示します。
(ms単位で調節するようにコードしてありますが、実際にはそんな精度では効いていないようです。)
ModernStandbySupported:	PCがモダンスタンバイに対応しているかどうかの判定結果。

[Color_Font]セクション
[Format]
[Mouse]
[Graph]
[AnalogClock]
[Tooltip]
以上の項目については、ダイアログで設定した項目が保存されています。手動変更可能ですが、ダイアログからの設定をお勧めします。

以下の項目は、iniファイル編集のみで設定可能です。
Saturday_TextColor=16777216
Sunday_TextColor=16777216
Holiday_TextColor=16777216
土曜日、日曜日、祝日に文字色を変更します。カスタム書式の中に"WCS"が使われていると指定領域の文字色が、使われていなければ全体の文字色が変わります。

VPN_TextColor=16777216	VPN接続時に文字の色を変えて特に目立つようにできます。

※これらのオプション文字色は(BGR値としてはあり得ない)16777216以上の数字を入れておくと無効化されます。デフォルトでは無効になっています。
※色設定は、R, G, Bを0-255の整数として、B*65536+G*256+R (16進数で2桁ずつ。Bが上位桁なので注意)。例：赤:255、緑:65280、青：16711680、黄色：65535,

[BarMeter]
・BL(バッテリ残量%)、VL&VM(ボリュームとミュート状態)，CU(CPU負荷)を示す縦のバーを表示できます。
・縦型バーの場合のみCPUコア別負荷表示バーが表示できます(Ver 3.3.6以降)。ダイアログ実装されていませんので主導でiniファイルを編集してください。
・色およびCPUコア別バー以外の設定項目はダイアログから設定できます。色は下記の要領でtclock-win10.ini内で設定できます。
※色設定は、R, G, Bを0-255の整数として、B*65536+G*256+R。例：赤:255、緑:65280、青：16711680、黄色：65535

ColorBarMeterVL=65280		ボリュームバーの表示色, デフォルトは緑
ColorBarMeterVL_Mute=255	ボリュームバーのミュート時の表示色, デフォルトは赤

ColorBarMeterBL_Charge=65280	バッテリ充電中の表示色(充電中は残量にかかわらずこの色になる), デフォルトはオレンジ
ColorBarMeterBL_High=65280	バッテリバー50%以上の表示色, デフォルトは緑
ColorBarMeterBL_Mid=65535	バッテリバー20-49%の表示色, デフォルトは黄色
ColorBarMeterBL_Low=255		バッテリバー19%以下の表示色, デフォルトは赤

ColorBarMeterCU_High=255	CPU負荷バー67%以上の表示色, デフォルトは赤
ColorBarMeterCU_Mid=65535	CPU負荷バー34-66%の表示色, デフォルトは黄色
ColorBarMeterCU_Low=65280	CPU負荷バー33%以下の表示色, デフォルトは緑

ネットワーク通信速度のメーターバーの色は、『TClockのプロパティ』⇒『時計』⇒『グラフ』で設定した色が使われます。

CPUコア別表示は、以下の項目が設定できます。
UseBarMeterCore=0		コア別バーの有効/無効, デフォルトは無効
NumberBarMeterCore=8		コア別バーの数(実際より大きくてもOK, 最大10)
ColorBarMeterCore_High=255	コア別バーの色(67%以上)
ColorBarMeterCore_Mid=65535	コア別バーの色(34-66%)
ColorBarMeterCore_Low=65280	コア別バーの色(33%以下)
BarMeterCore_Width=5		コア別バーの幅
BarMeterCore_Spacing=2		コア別バーの間隔
BarMeterCore_Left=0		コア別バーの左端の位置(0ならCPU負荷バーすぐ右)

[VPN]セクション
VPNインジケータ表示(書式"VPNS")のための検出キーワード。
SoftEtherKeyword="VPN Client Adapter"
VPN_Keyword1〜5: 未設定
・キーワードと一致するアダプタが"OPERAIONAL"状態の場合、VPN接続が成立しているとみなします。

VPN_Exclude1〜5: 未設定
・キーワードと一致するアダプタについては、"OPERAIONAL"状態でもVPN接続ではないと強制的にみなします。VPN_Keywordの設定との兼ね合いで誤判定が生じる場合に利用します。VPN_Keywordの効果より上位です。

※コントロールパネルに現れないアダプタ名は、たとえば"TCP Monitor Plus"のIF詳細情報取得機能などで得てください。
※文字色設定は[Color_Font]セクションにあります。
VPN_TextColor: VPN接続時の文字色。

[ETC]セクション
ZombieCheckInterval=5 (5 - 300)
何秒に1回、タスクトレイへのフックの維持を確認するか。
TClockのプロセスが動いているのに時計の改造に失敗している『ゾンビ状態』になっていないかを確認します。
ゾンビ状態になった際に再起動するか、終了するかは、b_AutoRestartの設定に従います。

LTEString = LTE
LTE書式の際に、LTE(WAN)接続成立時に表示される文字列。右クリックメニューにも反映されます。

LTEChar = L
ICP書式等において、LTE(WAN)接続成立時に表示される文字です。(先頭一文字のみ有効)

MuteString = *
VM書式において、ミュート時に表示される文字列です。

NetMIX_Length = 10
NMX1およびNMX2書式の文字列幅です。

SSID_AP_Length = 10
SSIDおよびAPN書式の文字列幅です。

Ethernet_Keyword1-5
イーサネットアダプタを判定するキーワード。
イーサネット接続であるかどうかの確定のためにアダプタ名に"Ethernet"が含まれるという条件を使っていますが、製品によっては"Ethernet"の文字列を含まない場合があります。
その場合の判定のため、コントロールパネルのネットワークアダプタ名(の一部)をこれらの文字列のどれかに設定することでイーサネット接続と判定できるようになります。

AdditionalMountPath0〜9
ドライブをNTFSマウントしたフォルダのフルパスを記入すると、ドライブレター:0〜9としてHDD容量の書式が使えるようになります。NTFSマウントが解除された場合はフォルダの親ドライブの情報を表示します。HDD容量の書式については、従来のTClock2chカスタム書式を参照してください。
※例: 『HT[A-Z]M = [A-Z]ドライブの合計サイズ (MB単位)』という書式で、[A-Z]のところに0から9の数字を入れて使います。
http://tclock2ch.no.land.to/help2ch/template.html

***************
バージョン履歴
***************

Ver. 4.5.0.1 (2022/02/13) の更新点
・メインの公開方法をGitHubに移行しました。
・Windows11において設定色によっては通知アイコンが正しく表示されない問題を修正しました。

Ver. 4.2.2.2 (2022/01/15) の更新点
・"mmmm"書式で12月が正常に表示されないバグを修正しました。
・Windows11で通知数を表示できるようになり、表示ずれを起こりにくくしました。
・Windows11でのサブモニタ表示に対応しました(試験的)

Ver. 4.1.6.2 (2021/12/08) の更新点
・週末/休日の文字色やVPN接続時の文字色の設定画面を追加しました(『色設定2』)。これにともなって"WCS"および"WCE"書式を廃止しました。
・各種機能のためのキーワード設定画面を追加しました(『その他』設定)。例えば有線LANが検出できない場合には『Ethernetキーワード』を設定してください。
・右クリックメニューやマウスクリックでWindows標準の『アラーム＆クロック』を起動できるようにしました。
・ほかの時計にぴったり合わせたいケースを想定して、表示時刻を一定量ずらす機能を実装しました(『書式』設定, 最大10秒)。
・ツールチップの表示処理を見直し、効果のない設定を廃止しました。
・マウスクリック動作への遅れが気になる方は、『マウス操作』設定において、必要のないクリック回数に対する動作を『なし』に設定してください。
・Windows11においてレジストリを操作して『小さいタスクバー』表示にしている場合に対応しました。小さいタスクバーでアイコンが下にずれる問題も改善するようにしています(『Windows11対応』設定)。
・Windows11でタスクバー右端からデスクトップ表示できるようにしました。

Ver. 4.0.3.5 (2021/11/24) の更新点
・Windows11に暫定対応しました。正しい動作のために『その他＆Win11』設定の数値の手動調整が必要な場合があります。
・サブモニタのタスクバー時計を改造できるようになりました
(サブモニタ時計の機能は右クリックメニューのみです。 Win11向けには未実装です)。
・ツールチップ表示を無効化する設定を追加しました『ツールチップ』設定。
・不要と思われる機能や書式を整理しました。

Ver. 3.4.5.2(2021/10/14):
・横置きかつ通常サイズの(小さくない)タスクバーで、書式が1行表示の際にグラフ等のベースラインが下端に移動できないバグを修正しました。
・背景透過の際の文字表示を改善しました。テーマ変更時の縁取りも出なくなりました。

Ver. 3.4.4.1(2021/01/01):
・CPU負荷およびクロックの表示アルゴリズムを修正し、2桁の論理プロセッサ(スレッド)番号に対応しました。
※従来の書式説明にはコア別と書かれていますが実際には論理プロセッサ(スレッド)ごとの負荷とクロックです。特にクロックはあまり正確ではありませんので参考程度と考えてください。
・PCORE(コア数), LPROC(論理プロセッサ数=スレッド数)書式追加

Ver. 3.4.3.1(2021/01/01):
・CPU負荷およびクロックの表示アルゴリズムを修正しました。
これまでコア別としていましたが実際には論理プロセッサ(スレッド)ごとの負荷とクロックです。特にクロックはあまり正確ではありませんので参考程度と考えてください。

Ver. 3.4.2.1(2020/9/28)
・WindowsのLight(白)テーマ等で色が薄くなる問題に対処しました。
なお、TClock-Win10の背景色を設定していない(透過設定)の場合、TClock-Win10動作中にWindowsのシステムテーマの変更を行うとフォントによっては文字の縁取りが出ます。TClock-Win10の設定変更もしくは再起動をすると縁取りは出なくなります。
・ドライブレターのほかにNTFSマウントフォルダ名でもドライブ容量を表示できるようにしました(要TClock-Win10.iniファイル直接編集)。
・時差指定書式td, tu, teを実装しました。
・週末・祝日に文字色を変える領域を指定できるようにしました。
・付属のツールチップテンプレートを更新しました。

Ver. 3.3.9.2 (2020/05/5)
・デフォルト設定で祝日の文字色が黒くなってしまう問題を修正しました。

Ver. 3.3.9.1 (2020/04/27)
・tclockwin10.iniの[Color_Font]セクションにSaturday_TextColor, Sunday_TextColor, Holiday_TextColorを追加しました。土曜日、日曜日、祝日に文字色を変更できます。
・tclockwin10.iniの[Color_Font]セクションにVPN_TextColor項目を追加しました。VPN接続時に文字の色を変えて目立つようにできます。
・マウスクリックメニューに、"利用できるネットワークの表示"機能を追加しました。
Ver. 3.3.8.1 (2020/02/16)
・Vecterのコメントで指摘されたExeplorer.exeに現れるメモリリークを解消(hain様ありがとうございます)
・VPNの判定から強制的に除外するVPN_Exclude1-5のtclock-win10.ini設定項目を追加

Ver. 3.3.7.1 (2019/12/15)
・縦型(スクリーン横)タスクバーでの表示を改善。

Ver. 3.3.6.1 (2019/12/** 非公開)
・ハンドルネームを"ITTT"⇒"TTTT"に変更
・ネットワーク累積通信量表示が異常になる場合に対処
・ネットワーク累積通信量の新しい書式(NRAG, NRAA, NSAG, NSAA)を追加
・メモリ関係の新しい書式(MG, MS, MTPGほか)を追加
・コア別負荷バー表示機能追加
・そのほか安定性向上

Ver. 3.3.5.1 (2019/10/04)
・VPNの検出アルゴリズムを改良(VPN_Keywordの再設定が必要な場合があります)
・モダンスタンバイ対応機種において、レジューム時に時折発生する早回しのような異常表示に対策
・サウンド機能が無いPCで異常動作する問題に対策

Ver. 3.3.4.1 (2019/01/01)
・リムーバブルドライブの取り外し機能：USB HDDの取り外しに対応
・設定ファイル(tclock-win10.ini)のETCセクションにEthernet_Keyword1-5を追加

Ver. 3.3.3.1 (2018/12/06)
・再起動の仕組みを小変更
・ゾンビ化の定期的確認機能を搭載
・NormalLogの記録機能を搭載("TClock-Win10.log")
・デバッグログのファイル名を"TCLOCK-WIN10.LOG"から"TCLOCK-WIN10-DEBUG.LOG"に変更
・データプラン利用量取得周期(ConnectionStatusCheckPeriod)に対するダイアログを追加
・データプラン利用量取得周期のデフォルトを30秒に
・WarnDelayedUsageRetrieval設定項目を追加(手動ファイル編集設定用)
・秒表示修正の仕組みを変更
・AdjustThreshold設定項目を追加

Ver. 3.3.2.1 (2018/11/25)
・二重起動時に再起動を選択可能にした(トレイクロックだけ消えるゾンビのケースにも有効)。
・UnplugDriveあり+ネットワークドライブ有り+VPN利用時に右クリックメニューが出なくなる問題を解決。
・LTEプロファイルの推定にプロファイル名を利用するようにした。
・iniファイルエントリ名を微修正。
・過剰と思われるスワップアウトを無効化

Ver. 3.3.1.1 (2018/11/18)
・公開開始

